<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
    "http://struts.apache.org/dtds/struts-2.3.dtd">

<struts order="20">

	<!-- CONVENTION PLUGIN COMPATIBILITY -->
	<constant name="struts.convention.action.fileProtocols" value="jar,zip" />
	<constant name="struts.convention.actionConfigBuilder" value="convention" />
	<constant name="struts.convention.actionNameBuilder" value="convention" />
	<constant name="struts.convention.resultMapBuilder" value="convention" />
	<constant name="struts.convention.interceptorMapBuilder" value="convention" />
	<constant name="struts.convention.conventionsService" value="convention" />
	<constant name="struts.convention.result.path" value="/WEB-INF/content/" />
	<constant name="struts.convention.result.flatLayout" value="true" />
	<constant name="struts.convention.action.suffix" value="Action" />
	<constant name="struts.convention.action.disableScanning" value="false" />
	<constant name="struts.convention.action.mapAllMatches" value="false" />
	<constant name="struts.convention.action.checkImplementsAction" value="true" />
	<constant name="struts.convention.default.parent.package" value="convention-default" />
	<constant name="struts.convention.action.name.lowercase" value="true" />
	<constant name="struts.convention.action.name.separator" value="-" />
	<constant name="struts.convention.package.locators" value="action,actions,struts,struts2" />
	<constant name="struts.convention.package.locators.disable" value="false" />
	<constant name="struts.convention.package.locators.basePackage" value="" />
	<constant name="struts.convention.exclude.packages" 
		value="com.google.code.rees.*,org.apache.struts.*,org.apache.struts2.*,org.springframework.web.struts.*,org.springframework.web.struts2.*,org.hibernate.*" />
	<constant name="struts.convention.relative.result.types" value="dispatcher,velocity,freemarker" />
	<constant name="struts.convention.redirect.to.slash" value="true" />
	<constant name="struts.convention.action.alwaysMapExecute" value="true" />
	<constant name="struts.mapper.alwaysSelectFullNamespace" value="true" />
	<constant name="struts.convention.action.fileProtocols" value="jar" />
	<constant name="struts.convention.classes.reload" value="false" />
	<constant name="struts.convention.exclude.parentClassLoader" value="true" />
		
	<!-- SCOPE -->
	<constant name="conversation.package.nesting" value="false" />
	<constant name="struts.scope.followsConvention" value="true" />
	<constant name="overengineer.monitoring.frequency" value="300000"/>
	<constant name="conversation.idle.timeout" value="28800000"/>
	<constant name="conversation.max.instances" value="20"/>
	<constant name="overengineer.monitoring.thread.pool.size" value="20"/>
	
	<constant name="com.github.overengineer.scope.container.ScopeContainer" value="defaultScopeContainer"/>
	<constant name="com.github.overengineer.scope.ActionProvider" value="strutsActionProvider"/>
	
	<constant name="com.github.overengineer.scope.conversation.configuration.ConversationConfigurationProvider" value="defaultConversationConfigurationProvider"/>
	<constant name="com.github.overengineer.scope.conversation.configuration.ConversationArbitrator" value="strutsConversationArbitrator"/>
	<constant name="com.github.overengineer.scope.conversation.processing.ConversationProcessor" value="defaultConversationProcessor"/>
	<constant name="com.github.overengineer.scope.conversation.context.JeeConversationContextManagerProvider" value="defaultConversationContextManagerProvider"/>
	<constant name="com.github.overengineer.scope.conversation.context.ConversationContextFactory" value="defaultConversationContextFactory"/>
	
	<constant name="com.github.overengineer.scope.session.SessionConfigurationProvider" value="defaultSessionConfigurationProvider"/>
	<constant name="com.github.overengineer.scope.session.SessionManager" value="defaultSessionManager"/>
	
	<constant name="com.github.overengineer.scope.conversation.expression.eval.Eval" value="ognl"/>
	<constant name="com.github.overengineer.scope.conversation.expression.configuration.ExpressionConfigurationProvider" value="defaultExpressionConfigurationProvider"/>
	
	<constant name="com.github.overengineer.scope.monitor.SchedulerProvider" value="defaultSchedulerProvider"/>
	<constant name="com.github.overengineer.scope.monitor.TimeoutMonitor" value="scheduledExecutorTimeoutMonitor"/>
	<constant name="com.github.overengineer.scope.conversation.context.ConversationContextManager" value="timeoutConversationContextManager"/>
	
	<bean name="default" 
		type="com.github.overengineer.scope.container.ScopeContainerProvider"
		class="com.github.overengineer.scope.struts2.StrutsScopeContainerProvider" />
	
	<bean name="defaultScopeContainer" 
		type="com.github.overengineer.scope.container.ScopeContainer"
		class="com.github.overengineer.scope.struts2.StrutsScopeContainer" />
	
	<bean name="strutsActionProvider" 
		type="com.github.overengineer.scope.ActionProvider"
		class="com.github.overengineer.scope.struts2.StrutsActionProvider" />
		
	<bean name="strutsConversationArbitrator" 
		type="com.github.overengineer.scope.conversation.configuration.ConversationArbitrator"
		class="com.github.overengineer.scope.struts2.StrutsConversationArbitrator"/>
		
	<bean name="defaultConversationConfigurationProvider"
		type="com.github.overengineer.scope.conversation.configuration.ConversationConfigurationProvider"
		class="com.github.overengineer.scope.conversation.configuration.DefaultConversationConfigurationProvider" />
		
	<bean name="defaultConversationProcessor"
		type="com.github.overengineer.scope.conversation.processing.ConversationProcessor"
		class="com.github.overengineer.scope.conversation.processing.InjectionConversationProcessor" />
		
	<bean name="defaultConversationContextManagerProvider" 
		type="com.github.overengineer.scope.conversation.context.JeeConversationContextManagerProvider" 
		class="com.github.overengineer.scope.conversation.context.DefaultJeeConversationContextManagerProvider"/>
		
	<bean name="defaultConversationContextFactory" 
		type="com.github.overengineer.scope.conversation.context.ConversationContextFactory" 
		class="com.github.overengineer.scope.conversation.context.DefaultConversationContextFactory"/>
		
	<bean name="defaultSessionConfigurationProvider"
		type="com.github.overengineer.scope.session.SessionConfigurationProvider"
		class="com.github.overengineer.scope.session.DefaultSessionConfigurationProvider" />

	<bean name="defaultSessionManager"
		type="com.github.overengineer.scope.session.SessionManager"
		class="com.github.overengineer.scope.session.DefaultSessionManager" />
		
	<bean name="ognl" 
		type="com.github.overengineer.scope.conversation.expression.eval.Eval" 
		class="com.github.overengineer.scope.conversation.expression.eval.Ognl"/>
		
	<bean name="expressionConversationProcessor" 
		type="com.github.overengineer.scope.conversation.processing.ConversationProcessor" 
		class="com.github.overengineer.scope.conversation.expression.processing.ExpressionConversationProcessor"/>
		
	<bean name="defaultExpressionConfigurationProvider" 
		type="com.github.overengineer.scope.conversation.expression.configuration.ExpressionConfigurationProvider" 
		class="com.github.overengineer.scope.conversation.expression.configuration.DefaultExpressionConfigurationProvider"/>
	
	<bean name="defaultSchedulerProvider" 
		type="com.github.overengineer.scope.monitor.SchedulerProvider" 
		class="com.github.overengineer.scope.monitor.DefaultSchedulerProvider"/>	
		
	<!-- prototypes -->
	<bean name="timeoutConversationContextManager"
		type="com.github.overengineer.scope.conversation.context.ConversationContextManager" 
		class="com.github.overengineer.scope.conversation.context.TimeoutConversationContextManager"/>
		
	<bean name="scheduledExecutorTimeoutMonitor"
		type="com.github.overengineer.scope.monitor.TimeoutMonitor" 
		class="com.github.overengineer.scope.monitor.ScheduledExecutorTimeoutMonitor"/>

	<package name="struts-conversation-default" extends="struts-default">
	
		<result-types>
		
			<result-type 
				name="conversationRedirectAction" 
				class="com.github.overengineer.scope.struts2.ConversationActionRedirectResult"/>
			
			<result-type 
				name="conversationRedirect" 
				class="com.github.overengineer.scope.struts2.ConversationRedirectResult"/>
				
		</result-types>
	
		<interceptors>
		
			<interceptor name="sessionField"
				class="com.github.overengineer.scope.struts2.SessionInterceptor" />
				
			<interceptor name="conversation"
				class="com.github.overengineer.scope.struts2.ConversationInterceptor">
				<param name="shortCircuitResults">input,login,error</param>	
			</interceptor>
			
			<interceptor-stack name="defaultConversationStack">
                <interceptor-ref name="exception"/>
                <interceptor-ref name="sessionField" />
				<interceptor-ref name="conversation" />
                <interceptor-ref name="alias"/>
                <interceptor-ref name="servletConfig"/>
                <interceptor-ref name="i18n"/>
                <interceptor-ref name="prepare"/>
                <interceptor-ref name="chain"/>
                <interceptor-ref name="scopedModelDriven"/>
                <interceptor-ref name="modelDriven"/>
                <interceptor-ref name="fileUpload"/>
                <interceptor-ref name="checkbox"/>
                <interceptor-ref name="multiselect"/>
                <interceptor-ref name="staticParams"/>
                <interceptor-ref name="actionMappingParams"/>
                <interceptor-ref name="params">
                    <param name="excludeParams">dojo\..*,^struts\..*,^session\..*,^request\..*,^application\..*,^servlet(Request|Response)\..*,parameters\...*,.*_conversation</param>
                </interceptor-ref>
                <interceptor-ref name="conversionError"/>
                <interceptor-ref name="validation">
                    <param name="excludeMethods">input,back,cancel,browse</param>
                </interceptor-ref>
                <interceptor-ref name="workflow">
                    <param name="excludeMethods">input,back,cancel,browse</param>
                </interceptor-ref>
                <interceptor-ref name="debugging"/>
            </interceptor-stack>
			
		</interceptors>
		
		<default-interceptor-ref name="defaultConversationStack" />
		
	</package>
	
</struts>
